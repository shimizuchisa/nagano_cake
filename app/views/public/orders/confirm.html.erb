<body>
  <%= render 'layouts/public_header_template' %>
  <main>
    <div class="container">
      <h1 class="mb-5">ご注文内容確認</h1>
      <div class="row">
        <div class="col-10">
          <%= form_with model: @order, url: orders_path, method: :post do |f| %>
          <table>
            <tr>
              <th>お届け先</th>
              <th><%= @order.address_display %></th>
            </tr>
            <tr>
              <th>配送料</th>
              <th><%= @order.shipping_cost %> 円</th>
            </tr>
            <tr>
              <th>ご請求金額</th>
              <th>
                <% @cart_items.each do |cart_item| %>
                  <% sub_total = cart_item.amount * cart_item.item.with_tax_price %>
                  <% @total += sub_total %>
                <% end %>
                <%= @order.grand_total = @total + @order.shipping_cost.to_i %>
              </th>
            </tr>
            <tr>
              <th>お支払い方法</th>
              <th><%= @order.payment_method %></th>
            </tr>
          </table>
            <%= f.hidden_field :payment_method, value: @order.payment_method %>
            <%= f.hidden_field :postal_code, value: @order.postal_code %>
            <%= f.hidden_field :address, value: @order.address %>
            <%= f.hidden_field :name, value: @order.name %>
            <%= f.hidden_field :grand_total, value: @order.grand_total %>

            <%= f.submit "注文確定", class: "btn btn-success" %>
          <% end %>

        <%= link_to "カートに戻る", cart_items_path, method: :get, class: "btn btn-success" %>

        </div>
      </div>
    </div>
  </main>
  <%= render 'layouts/footer_template' %>
</body>